query GetPullRequestForCommit($owner: String!, $repo: String!, $sha: String ) {
  repository(name: $repo, owner: $owner) {
    commit: object(expression: $sha) {
      ... on Commit {
        associatedPullRequests(first:1) {
            nodes {
              number
            }
        }
      }
    }
  }
}

query GetPullRequestAndCommentsForCommit($owner: String!, $repo: String!, $sha: String) {
  repository(name: $repo, owner: $owner) {
    commit: object(expression: $sha) {
      ... on Commit {
        associatedPullRequests(first: 1) {
          nodes {
            number
            ... on PullRequest {
              id
              comments(first: 100) {
                nodes {
                  id
                  url
                  author {
                    login
                  }
                  body
                }
                pageInfo {
                  hasNextPage
                }
              }
            }
          }
        }
      }
    }
  }
}


# {
#  "sha": "a871cf3372c1ac1bc49d54cda5945091ba161b65",
#  "repo": "districts-jobs",
#  "owner": "Khan"
# }

query GetCommentsForPullRequest($url: URI!) {
  resource(url: $url) {
    ... on PullRequest {
      comments(first: 100) {
        nodes {
          id
          url
          author {
            login
          }
          body
        }
        pageInfo {
          hasNextPage
        }
      }
    }
  }
}

# {
#   "url": "https://github.com/Khan/districts-jobs/pull/499"
# }

mutation UpdatePullRequestComment($commentId: ID!, $body: String!) {
  updateIssueComment(input: { id: $commentId, body: $body }) {
    issueComment {
      id
    }
  }
}

mutation CreateNewPullRequestComment($prId: ID!, $body: String!) {
  addComment(input: { subjectId: $prId, body: $body }) {
    commentEdge {
      node {
        id
      }
    }
  }
}